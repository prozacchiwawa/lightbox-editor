#r "node_modules/fable-core/Fable.Core.dll"

open Fable.Core
open Fable.Import.Browser

#load "util.fs"
#load "q.fs"
#load "blob.fs"
#load "zip.fs"

open Util
open Q
open Blob
open Zip

[<Emit("console.log($0)")>]
let log : string -> unit = fun _ -> failwith "JS"

let zipfile = "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"

let cssreset = "aHRtbCwgYm9keSwgZGl2LCBzcGFuLCBhcHBsZXQsIG9iamVjdCwgaWZyYW1lLApoMSwgaDIsIGgzLCBoNCwgaDUsIGg2LCBwLCBibG9ja3F1b3RlLCBwcmUsCmEsIGFiYnIsIGFjcm9ueW0sIGFkZHJlc3MsIGJpZywgY2l0ZSwgY29kZSwKZGVsLCBkZm4sIGVtLCBpbWcsIGlucywga2JkLCBxLCBzLCBzYW1wLApzbWFsbCwgc3RyaWtlLCBzdHJvbmcsIHN1Yiwgc3VwLCB0dCwgdmFtciwKYiwgdSwgaSwgY2VudGVyLApkbCwgZHQsIGRkLCBvbCwgdWwsIGxpLApmaWVsZHNldCwgZm9ybSwgbGFiZWwsIGxlZ2VuZCwKdGFibGUsIGNhcHRpb24sIHRib2R5LCB0Zm9vdCwgdGhlYWQsIHRyLCB0aCwgdGQsCmFydGljbGUsIGFzaWRlLCBjYW52YXMsIGRldGFpbHMsIGVtYmVkLApmaWd1cmUsIGZpZ2NhcHRpb24sIGZvb3RlciwgaGVhZGVyLCBoZ3JvdXAsCm1lbnUsIG5hdiwgb3V0cHV0LCBydWJ5LCBzZWN0aW9uLCBzdW1tYXJ5LAp0aW1lLCBtYXJrLCBhdWRpbywgdmlkZW8gewoJbWFyZ2luOiAwOwoJcGFkZGluZzogMDsKCWJvcmRlcjogMDsKCWZvbnQtc2l6ZTogMTAwJTsKCWZvbnQ6IGluaGVyaXQ7Cgl2ZXJ0aWNhbC1hbGlnbjogYmFzZWxpbmU7Cglmb250LWZhbWlseTogJ09wZW4gU2FucycsIHNhbnMtc2VyaWY7Cn0KCmxpIHsKCWxpc3Qtc3R5bGU6IG5vbmU7Cn0K"

let main _ =
  create "application/x-zip" [Base64Data zipfile] 
  |> (fun blob -> Zip.readZip blob)
  |>> Zip.zipContentFileString "css/reset.css"
  ||> (fun css -> Util.btoa css)
  ||> (fun css -> log (if cssreset = css then "true" else "false"))
  ||| (fun e -> log (String.concat ":" ["error";e]))
